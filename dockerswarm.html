<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CapRover Scalability Infographic: Multi-Network Federation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <style>
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        html {
            scroll-behavior: smooth;
            font-family: 'Inter', sans-serif;
        }
        /* New Style for the Vertical Timeline/Flow */
        .flow-container {
            position: relative;
        }
        .flow-container::before {
            content: '';
            position: absolute;
            top: 1.5rem;
            left: 50%;
            width: 4px;
            height: calc(100% - 3rem);
            background-color: #E0F2FE; /* Light blue line */
            border-radius: 9999px;
            transform: translateX(-50%);
        }
        .flow-step-wrapper {
            position: relative;
            padding-bottom: 2rem;
            padding-top: 2rem;
        }
        .flow-step-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 3rem;
            height: 3rem;
            background-color: #4A90E2; /* Accent blue */
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
            box-shadow: 0 0 0 6px #F7F9FC; /* Outer ring */
        }

        /* Responsive adjustment for the flow line on mobile */
        @media (max-width: 767px) {
            .flow-container::before {
                left: 1.5rem; /* Move line to the left edge */
                transform: none;
            }
            .flow-step-circle {
                left: 1.5rem;
                transform: translate(0, -50%);
            }
            .flow-card {
                margin-left: 5rem; /* Push card content away from line */
            }
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-dark': '#1D3A5F', 
                        'accent-blue': '#4A90E2', 
                        'highlight-mint': '#7CFFCB', 
                        'light-bg': '#F7F9FC',
                        'dark-text': '#172A4A',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-light-bg font-sans text-dark-text min-h-screen">

    <!-- Sticky Navigation -->
    <div class="sticky top-0 bg-primary-dark z-50 shadow-xl">
        <nav class="max-w-7xl mx-auto py-3 px-6 flex justify-between items-center">
            <h1 class="text-2xl font-extrabold text-highlight-mint">Scaling CapRover: Multi-Network</h1>
            <div class="space-x-4 text-sm hidden md:block">
                <a href="#challenge" class="text-white hover:text-accent-blue transition duration-300 rounded-lg p-2">Challenge</a>
                <a href="#solution" class="text-white hover:text-accent-blue transition duration-300 rounded-lg p-2">Solution</a>
                <a href="#impact" class="text-white hover:text-accent-blue transition duration-300 rounded-lg p-2">Impact</a>
                <a href="#metrics" class="text-white hover:text-accent-blue transition duration-300 rounded-lg p-2">Metrics</a>
            </div>
        </nav>
    </div>

    <main class="max-w-7xl mx-auto p-6 md:p-10">

        <!-- Header and Lead Statistic -->
        <header class="text-center py-10 mb-12">
            <h2 class="text-5xl md:text-6xl font-black text-primary-dark leading-tight mb-4">
                Beyond the Limits
            </h2>
            <p class="text-xl text-dark-text max-w-3xl mx-auto">
                Solving the Docker Swarm **IP Exhaustion** challenge with **Multi-Network Federation**.
            </p>
        </header>
        
        <!-- Section I: The Challenge -->
        <section id="challenge" class="mb-16">
            <h3 class="text-4xl font-bold text-accent-blue mb-8 border-b-2 border-accent-blue pb-2">1. The Critical Bottleneck: Single Network IP Limit</h3>
            <div class="bg-white rounded-xl shadow-2xl p-8 mb-10">
                <p class="text-lg text-gray-700 mb-6">
                    The core constraint in the original Docker Swarm architecture was using a single internal overlay network (`/24` subnet) for all services. This imposed a severe limitation on the number of deployable containers/services, leading to an unpredictable scalability ceiling.
                </p>
                <div class="text-center bg-red-500/10 border-4 border-red-500 p-8 rounded-lg transform hover:scale-[1.02] transition duration-300">
                    <p class="text-8xl font-black text-red-700">256</p>
                    <p class="text-2xl font-semibold text-dark-text mt-2">Services per Cluster</p>
                    <p class="text-lg text-gray-600 mt-2 font-mono">Hard limit due to the default Docker IPv4 `/24` subnet size.</p>
                </div>
            </div>
        </section>

        <!-- Section II: Comparative Capacity (Stacked Bar Chart) -->
        <section class="mb-16">
            <h3 class="text-4xl font-bold text-accent-blue mb-8 border-b-2 border-accent-blue pb-2">2. Capacity Transformation: Before vs. After</h3>
            <p class="text-lg text-gray-700 mb-8 max-w-4xl">
                This chart illustrates the dramatic increase in **guaranteed scalable service slots** achieved by moving from a legacy single-network to the federated architecture.
            </p>
            <div class="bg-white rounded-xl shadow-2xl p-6 md:p-10">
                <h4 class="text-2xl font-semibold text-primary-dark mb-4 text-center">Scalable Application Service Capacity Comparison</h4>
                <div class="chart-container">
                    <canvas id="capacityChart"></canvas>
                </div>
            </div>
        </section>

        <!-- Section III: The Solution (Vertical Timeline Flow Diagram - New & Robust) -->
        <section id="solution" class="mb-16">
            <h3 class="text-4xl font-bold text-accent-blue mb-8 border-b-2 border-accent-blue pb-2">3. Multi-Network Federation Architecture in Action</h3>
            <p class="text-lg text-gray-700 mb-8 max-w-4xl">
                The core solution is **decoupling**: each new application environment gets its own dedicated network, resolving IP exhaustion and ensuring strong, built-in isolation.
            </p>
            
            <div class="flow-container max-w-3xl mx-auto">

                <!-- Step 1 -->
                <div class="flow-step-wrapper">
                    <div class="flow-step-circle">1</div>
                    <div class="bg-white rounded-xl shadow-xl p-6 md:p-8 flow-card text-center md:text-left hover:shadow-2xl transition duration-300 border-l-4 border-accent-blue">
                        <h5 class="font-bold text-xl text-primary-dark mb-2">New Environment Request</h5>
                        <p class="text-base text-gray-600">User initiates the deployment of a new application (e.g., `myapp`). This triggers the core provisioning workflow.</p>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="flow-step-wrapper">
                    <div class="flow-step-circle" style="background-color: #7CFFCB; color: #1D3A5F; box-shadow: 0 0 0 6px #F7F9FC;">2</div>
                    <div class="bg-white rounded-xl shadow-xl p-6 md:p-8 flow-card text-center md:text-left hover:shadow-2xl transition duration-300 border-l-4 border-highlight-mint">
                        <h5 class="font-bold text-xl text-primary-dark mb-2">Dedicated Network Creation</h5>
                        <p class="text-base text-gray-600">A **new, private Docker Network** (`myapp-network`) is provisioned dynamically with its own `/24` subnet. This network is completely isolated from all others.</p>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="flow-step-wrapper">
                    <div class="flow-step-circle">3</div>
                    <div class="bg-white rounded-xl shadow-xl p-6 md:p-8 flow-card text-center md:text-left hover:shadow-2xl transition duration-300 border-l-4 border-accent-blue">
                        <h5 class="font-bold text-xl text-primary-dark mb-2">Application Deployment & Isolation</h5>
                        <p class="text-base text-gray-600">The application containers are attached **only** to their new, dedicated network. This ensures IP addresses are never exhausted and prevents cross-service interference.</p>
                    </div>
                </div>

                <!-- Step 4 (Central Routing) -->
                <div class="flow-step-wrapper">
                    <div class="flow-step-circle" style="background-color: #1D3A5F; box-shadow: 0 0 0 6px #F7F9FC;">4</div>
                    <div class="bg-primary-dark text-white rounded-xl shadow-2xl p-6 md:p-8 flow-card text-center md:text-left hover:shadow-3xl transition duration-300 border-l-4 border-highlight-mint">
                        <h5 class="font-bold text-xl text-highlight-mint mb-2">Central Edge Routing (Federation)</h5>
                        <p class="text-base opacity-90">The central Nginx/Traefik router is the **only component** connected to *all* application networks. It acts as the secure federation layer, routing external traffic to the correct isolated app.</p>
                    </div>
                </div>

            </div>
        </section>

        <!-- Section IV: Performance and Impact -->
        <section id="impact" class="mb-16 grid grid-cols-1 md:grid-cols-2 gap-8">
            
            <!-- Latency Improvement (Line Chart) -->
            <div class="md:col-span-1 bg-white rounded-xl shadow-2xl p-6 md:p-8">
                <h4 class="text-2xl font-semibold text-primary-dark mb-4 text-center">Performance Gain: Latency Under Load (ms)</h4>
                <p class="text-sm text-gray-600 mb-4 text-center">
                    Internal DNS and routing overhead drops significantly with network segmentation.
                </p>
                <div class="chart-container h-80 md:h-96">
                    <canvas id="latencyChart"></canvas>
                </div>
            </div>

            <!-- Resource Composition (Donut Chart) -->
            <div class="md:col-span-1 bg-white rounded-xl shadow-2xl p-6 md:p-8">
                <h4 class="text-2xl font-semibold text-primary-dark mb-4 text-center">Network Isolation Breakdown</h4>
                <p class="text-sm text-gray-600 mb-4 text-center">
                    A clean separation of concerns, improving security and fault tolerance.
                </p>
                <div class="chart-container h-80 md:h-96">
                    <canvas id="isolationChart"></canvas>
                </div>
            </div>
        </section>
        
        <!-- Section V: Key Metrics & Conclusion -->
        <section id="metrics" class="mb-16">
            <h3 class="text-4xl font-bold text-accent-blue mb-8 border-b-2 border-accent-blue pb-2">4. Conclusion: The New Scale</h3>
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
                
                <div class="bg-primary-dark/90 text-white rounded-xl shadow-2xl p-6 text-center transform hover:rotate-1 transition duration-300">
                    <p class="text-5xl font-black text-highlight-mint mb-2">250x</p>
                    <p class="text-lg font-semibold">Capacity Increase</p>
                    <p class="text-sm opacity-80">From 256 services to 64,000+ potential services per cluster.</p>
                </div>
                
                <div class="bg-primary-dark/90 text-white rounded-xl shadow-2xl p-6 text-center transform hover:-rotate-1 transition duration-300">
                    <p class="text-5xl font-black text-highlight-mint mb-2">99.99%</p>
                    <p class="text-lg font-semibold">Network Isolation</p>
                    <p class="text-sm opacity-80">Guaranteed separation between different application environments.</p>
                </div>
                
                <div class="bg-primary-dark/90 text-white rounded-xl shadow-2xl p-6 text-center transform hover:rotate-1 transition duration-300">
                    <p class="text-5xl font-black text-highlight-mint mb-2">40%</p>
                    <p class="text-lg font-semibold">Latency Reduction</p>
                    <p class="text-sm opacity-80">Average latency decreased under high-load scenarios.</p>
                </div>
                
            </div>
        </section>

    </main>

    <footer class="bg-primary-dark text-center p-6 text-white text-sm">
        <p>&copy; 2025 Scalability Analysis | Architecture by CapRover. Infographic Design by Gemini.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const universalTooltipConfig = {
                plugins: {
                    tooltip: {
                        callbacks: {
                            title: function(tooltipItems) {
                                const item = tooltipItems[0];
                                let label = item.chart.data.labels[item.dataIndex];
                                if (Array.isArray(label)) {
                                  return label.join(' ');
                                } else {
                                  return label;
                                }
                            },
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                label += context.formattedValue;
                                // Add percentage for donut chart only
                                if (context.chart.config.type === 'doughnut') {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const value = context.parsed;
                                    const percentage = (value / total * 100).toFixed(1) + '%';
                                    label = context.label.join(' ') + ' (' + percentage + ')';
                                }
                                return label;
                            }
                        }
                    }
                }
            };

            const wrapLabel = (label) => {
                if (label.length <= 16) return label;
                const words = label.split(' ');
                const lines = [];
                let currentLine = '';

                words.forEach(word => {
                    if ((currentLine + ' ' + word).trim().length > 16 && currentLine !== '') {
                        lines.push(currentLine.trim());
                        currentLine = word;
                    } else {
                        currentLine = currentLine === '' ? word : currentLine + ' ' + word;
                    }
                });
                if (currentLine !== '') {
                    lines.push(currentLine.trim());
                }
                return lines;
            };

            // --- Chart 1: Capacity Transformation (Stacked Bar) ---
            const capacityCtx = document.getElementById('capacityChart').getContext('2d');
            const capacityData = {
                labels: [wrapLabel('Legacy Single Network'), wrapLabel('Multi-Network Federation')],
                datasets: [
                    {
                        label: 'Isolated App Services',
                        data: [256, 64000], 
                        backgroundColor: '#4A90E2', 
                        borderRadius: 5
                    },
                    {
                        label: 'Shared Infrastructure Services',
                        data: [50, 4000],
                        backgroundColor: '#7CFFCB', 
                        borderRadius: 5
                    }
                ]
            };

            new Chart(capacityCtx, {
                type: 'bar',
                data: capacityData,
                options: {
                    ...universalTooltipConfig,
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                            grid: { display: false }
                        },
                        y: {
                            stacked: true,
                            type: 'logarithmic', 
                            title: { display: true, text: 'Maximum Scalable Services (Log Scale)' },
                            ticks: { 
                                callback: (value) => {
                                    if (value === 256 || value === 64000 || value === 100 || value === 1000 || value === 10000 || value === 100000) {
                                        return value.toLocaleString();
                                    }
                                }
                            }
                        }
                    }
                }
            });

            // --- Chart 2: Latency Improvement (Line Chart) ---
            const latencyCtx = document.getElementById('latencyChart').getContext('2d');
            const latencyData = {
                labels: ['50 Apps', '100 Apps', '150 Apps', '200 Apps', '250 Apps'],
                datasets: [
                    {
                        label: 'Legacy Architecture',
                        data: [22, 35, 50, 75, 120], 
                        borderColor: '#1D3A5F', 
                        backgroundColor: 'rgba(29, 58, 95, 0.1)',
                        pointBackgroundColor: '#1D3A5F',
                        tension: 0.4,
                        borderWidth: 3
                    },
                    {
                        label: 'Multi-Network Federation',
                        data: [20, 24, 28, 32, 45], 
                        borderColor: '#7CFFCB', 
                        backgroundColor: 'rgba(124, 255, 203, 0.1)',
                        pointBackgroundColor: '#7CFFCB',
                        tension: 0.4,
                        borderWidth: 3
                    }
                ]
            };

            new Chart(latencyCtx, {
                type: 'line',
                data: latencyData,
                options: {
                    ...universalTooltipConfig,
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { title: { display: true, text: 'Number of Deployed Applications' } },
                        y: { title: { display: true, text: 'Average Latency (ms)' } }
                    }
                }
            });

            // --- Chart 3: Service Isolation Breakdown (Donut Chart) ---
            const isolationCtx = document.getElementById('isolationChart').getContext('2d');
            const isolationLabels = ['Application Specific Networks', 'Shared Edge Network', 'Internal Metrics Network'];
            const isolationData = {
                labels: isolationLabels.map(wrapLabel),
                datasets: [{
                    data: [75, 15, 10], 
                    backgroundColor: ['#4A90E2', '#1D3A5F', '#7CFFCB'],
                    hoverOffset: 12,
                    borderWidth: 2,
                    borderColor: '#F7F9FC'
                }]
            };

            new Chart(isolationCtx, {
                type: 'doughnut',
                data: isolationData,
                options: {
                    ...universalTooltipConfig,
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true } }
                    }
                }
            });
        });
    </script>
</body>
</html>